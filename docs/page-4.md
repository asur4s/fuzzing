
想起前段时间看过的一篇文章，文章的主题虽然不是Fuzzing，但是和Fuzzing息息相关。这篇文章就是《High-Level Approaches for Finding Vulnerabilities》，链接在文末可以找到。

这篇文章主要讲解的是漏洞挖掘的方法论，将漏洞挖掘进行抽象化的理解，我在下面稍微摘抄并整理一下自己的理解。
> PS：这里的漏洞指软件漏洞（通用漏洞），而不是错误配置或补丁管理导致的安全问题，后面这类安全问题借助简单的扫描器即可发现问题，并且通用性并不高。

顺便提一句，研究Java安全的人应该都很熟悉这个作者。访问下面这个链接你就明白了——[java.lang.Runtime.exec() Payload Workarounds](https://www.jackson-t.ca/runtime-exec-payloads.html)。

# 漏洞挖掘过程

学习机器学习时，教程会举一些简单的例子来帮助理解机器学习的大致步骤，比如《通过机器学习如何识别一只猫》。

漏洞挖掘的过程是什么样的？大致步骤是什么呢？这篇文章的作者将漏洞挖掘和解决迷宫问题做类比（拼图、逻辑网格）。探索简单的迷宫如下图所示

![](./images/2.gif)

不过，这个迷宫是比较特殊的，它有以下的特征：
```
1、你不能看到它的样子，也就是说你没有上帝视角，这个迷宫和真实世界的迷宫相似。
2、它有多个起点和多个终点，并且你不知道它们在哪。这里的起点指输入点，终点指不安全状态（漏洞）。
3、最终的地图几乎不会100％的清晰展示，但通过探索足以弄清楚如何从A点走到B点。
```
漏洞挖掘解决的迷宫如下图所示

![](./images/3.gif)

可以将上面的抽象总结成三个基本步骤：
```
1、枚举入口点（即与应用程序交互的方式）。
2、考虑对手想要表现出的不安全状态（即脆弱性）。
3、使用已识别的入口点操作应用程序以达到不安全的状态。
```
在这个过程中，迷宫就是你正在研究的应用程序，地图是你对它的理解，起点是你的入口点，终点是你想要造成的不安全状态。

上面的基本步骤可以作为漏洞挖掘的指路牌，在学习Fuzzing的时候，也可以按照以上的模式来思考。


# 漏洞类型

在文中，作者将漏洞分为两类（按照漏洞的使用方式）：
- 通用型：一般的漏洞(如RCE、SQLi、XSS等)可以在许多应用程序中寻找到，而不需要知道它们的业务逻辑（框架型漏洞）。
- 上下文型（逻辑漏洞）：需要了解更多的业务逻辑、信任级别和信任边界。

作者将`上下文`和`业务逻辑`这两个词进行关联，我产生了一个简单的猜想——AFL不适合逻辑漏洞，逻辑漏洞的挖掘需要从上下文相关的角度入手。
> PS：以后慢慢验证吧，这些博文会进行二次整理的。

他还提到了一个比较重要的关键词——STRIDE 威胁模型，利用 STRIDE 威胁模型来判断哪些位置容易受到攻击，感觉这种思想可以用在漏洞挖掘的过程中。

---

我才疏学浅，作者还有很多思想我没能感受到其妙用，我以后理解再放到这里吧。前面谈了太多理论的东西，准备开始搭环境。


参考文档：
- [High-Level Approaches for Finding Vulnerabilities](https://www.jackson-t.ca/finding-vulnerabilities.html)
- [挖掘漏洞的高级方法和思维（Part.1）](https://www.4hou.com/index.php/posts/YWqY)
- [挖掘漏洞得高级方法和思维（Part.2）](https://zhuanlan.zhihu.com/p/30982733)